<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Protected Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<!-- Placeholder for dynamic content -->
<div id="content"></div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript to fetch protected content -->
<script>
  // Check if the JWT token exists in localStorage
  const token = localStorage.getItem('jwtToken');

  if (token) {
    // Fetch the protected content from account.html
    fetch('/account.html', {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer ' + token  // Include JWT token in headers
      }
    })
            .then(response => {
              if (response.ok) {
                return response.text();  // Return the HTML content
              } else {
                throw new Error('Unauthorized or missing token');
              }
            })
            .then(htmlContent => {
              // Inject the HTML content into the page
              document.getElementById('content').innerHTML = htmlContent;
            })
            .catch(error => {
              console.error('Error fetching protected content:', error);
              alert('You must be logged in to access this page.');
              window.location.href = '/login.html';  // Redirect to login if not authenticated
            });
  } else {
    // Redirect to login if no token is found
    window.location.href = '/login.html';
  }
</script>

</body>
</html>
